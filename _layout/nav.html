<nav
    x-data="{
        navigationMenuOpen: false,
        navigationMenu: '',
        navigationMenuCloseDelay: 200,
        navigationMenuCloseTimeout: null,
        navigationMenuLeave() {
            let that = this;
            this.navigationMenuCloseTimeout = setTimeout(() => {
                that.navigationMenuClose();
            }, this.navigationMenuCloseDelay);
        },
        navigationMenuReposition(navElement) {
            this.navigationMenuClearCloseTimeout();
            this.$refs.navigationDropdown.style.left = navElement.getBoundingClientRect().left + 'px';
            this.$refs.navigationDropdown.style.marginLeft = (navElement.offsetWidth/2) + 'px';
        },
        navigationMenuClearCloseTimeout(){
            clearTimeout(this.navigationMenuCloseTimeout);
        },
        navigationMenuClose(){
            this.navigationMenuOpen = false;
            this.navigationMenu = '';
        }
    }"
    class="hidden md:relative md:flex z-10 items-center w-full h-24"
>
    <div
        class="relative flex flex-wrap items-start w-full mx-auto font-medium md:items-center justify-between md:h-24"
    >
        <a href="/" class="flex items-center font-extrabold text-white md:py-0">
            <img
                src="/assets/Presage_Logo_noTXT.svg"
                height="120"
                width="120"
            />
        </a>
        <div
            class="relative z-50 flex-col items-center justify-center w-1/2 h-auto px-2 py-2 text-center text-gray-400 rounded-md md:w-auto md:h-10 md:flex-row md:items-center"
        >
            <a
                href="/"
                class="inline-flex items-center justify-center h-10 px-4 py-2 text-xl font-medium text-gray-700 rounded-md hover:text-neutral-100 text-neutral-100 hover:bg-[#00638a] focus:outline-none disabled:opacity-50 disabled:pointer-events-none bg-[#00416b] group w-max"
            >
                HOME
            </a>
            <button
                :class="{ 'bg-[#00638a]' : navigationMenu=='about-us', 'hover:bg-[#00638a]' : navigationMenu!='about-us' }"
                @mouseover="navigationMenuOpen=true; navigationMenuReposition($el); navigationMenu='about-us'"
                @mouseleave="navigationMenuLeave()"
                class="inline-flex items-center justify-center h-10 px-4 py-2 text-xl font-medium text-gray-700 rounded-md hover:text-neutral-100 text-neutral-100 hover:bg-[#00638a] focus:outline-none disabled:opacity-50 disabled:pointer-events-none bg-[#00416b] group w-max"
            >
                <span>ABOUT US</span>
                <svg
                    :class="{ '-rotate-180' : navigationMenuOpen==true && navigationMenu == 'about-us' }"
                    class="relative top-[1px] ml-1 h-3 w-3 ease-out duration-300"
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    aria-hidden="true"
                >
                    <polyline points="6 9 12 15 18 9"></polyline>
                </svg>
            </button>
            <button
                :class="{ 'bg-[#00638a]' : navigationMenu=='learn-more', 'hover:bg-[#00638a]' : navigationMenu!='learn-more' }"
                @mouseover="navigationMenuOpen=true; navigationMenuReposition($el); navigationMenu='learn-more'"
                @mouseleave="navigationMenuLeave()"
                class="inline-flex items-center justify-center h-10 px-4 py-2 text-xl font-medium text-gray-700 rounded-md hover:text-neutral-100 text-neutral-100 hover:bg-[#00638a] focus:outline-none disabled:opacity-50 disabled:pointer-events-none bg-[#00416b] group w-max"
            >
                <span>SERVICES</span>
                <svg
                    :class="{ '-rotate-180' : navigationMenuOpen==true && navigationMenu == 'learn-more' }"
                    class="relative top-[1px] ml-1 h-3 w-3 ease-out duration-300"
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    aria-hidden="true"
                >
                    <polyline points="6 9 12 15 18 9"></polyline>
                </svg>
            </button>
        </div>

        <div
            class="relative z-40 items-center justify-end hidden w-1/4 h-auto text-sm bg-gray-900 bg-opacity-50 md:w-auto md:bg-transparent md:relative md:flex"
        >
            <div
                class="flex flex-col items-center justify-end w-full h-auto md:w-full md:flex-row"
            >
                <!-- opens a modal with a contact form. -->
                <div
                    x-data="{ modalOpen: false }"
                    @keydown.escape.window="modalOpen = false"
                    class="relative z-50 w-auto h-auto"
                >
                    <button
                        @click="modalOpen=true"
                        class="inline-flex items-center justify-center h-10 px-4 py-2 text-xl text-gray-100 bg-[#e76254] font-medium transition-colors rounded-xl hover:text-neutral-100 focus:outline-none focus:text-neutral-100 disabled:opacity-50 hover:bg-[#f5a455] focus:bg-[#f5a455] disabled:pointer-events-none group w-max"
                    >
                        WORK WITH US
                    </button>
                    <!-- Contains the rest of the logic for the modal -->
                    {{ insert contact.html }}
            </div>
        </div>
    </div>
    <div
        x-ref="navigationDropdown"
        x-show="navigationMenuOpen"
        x-transition:enter="transition ease-out duration-100"
        x-transition:enter-start="opacity-0 scale-90"
        x-transition:enter-end="opacity-100 scale-100"
        x-transition:leave="transition ease-in duration-100"
        x-transition:leave-start="opacity-100 scale-100"
        x-transition:leave-end="opacity-0 scale-90"
        @mouseover="navigationMenuClearCloseTimeout()"
        @mouseleave="navigationMenuLeave()"
        class="absolute top-0 pt-3 duration-200 ease-out -translate-x-1/2 translate-y-20"
        x-cloak
    >
        <div
            class="flex justify-center w-auto h-auto overflow-hidden bg-white border rounded-md shadow-sm border-neutral-200/70"
        >
            <div
                x-show="navigationMenu == 'about-us'"
                class="flex items-stretch justify-center w-full max-w-2xl p-6 gap-x-3"
            >
                <div
                    class="flex-shrink-0 w-48 rounded pt-28 pb-7 bg-gradient-to-br from-neutral-800 to-[#00415b]"
                >
                    <img
                        src="/assets/Presage_Logo_TXTwhite.svg"
                        style="width: 300px; height: 300px"
                    />
                    <div class="relative px-7 text-white">
                        <span class="block text-sm opacity-60"
                            >The experts in high-risk human
                            decision-making</span
                        >
                    </div>
                </div>
                <div class="w-72">
                    <a
                        href="/pages/story/"
                        @click="navigationMenuClose()"
                        class="block px-3.5 py-3 text-sm rounded hover:bg-neutral-100"
                    >
                        <span class="block mb-1 font-medium">Our Story</span>
                        <span class="block font-light leading-5 opacity-50"
                            >From academia to the flight deck</span
                        >
                    </a>
                    <a
                        href="/pages/how/"
                        @click="navigationMenuClose()"
                        class="block px-3.5 py-3 text-sm rounded hover:bg-neutral-100"
                    >
                        <span class="block mb-1 font-medium">How it Works</span>
                        <span class="block font-light leading-5 opacity-50"
                            >The Presage Process</span
                        >
                    </a>
                    <a
                        href="/pages/team"
                        @click="navigationMenuClose()"
                        class="block px-3.5 py-3 text-sm rounded hover:bg-neutral-100"
                    >
                        <span class="block mb-1 font-medium"
                            >Meet the Team</span
                        >
                        <span class="block leading-5 opacity-50"
                            >Who we are and what we do</span
                        >
                    </a>
                    <a
                        href="/pages/careers/"
                        @click="navigationMenuClose()"
                        class="block px-3.5 py-3 text-sm rounded hover:bg-neutral-100"
                    >
                        <span class="block mb-1 font-medium">Careers</span>
                        <span class="block leading-5 opacity-50"
                            >Join us to build the future of aviation</span
                        >
                    </a>
                    <a
                        href="/blog/"
                        @click="navigationMenuClose()"
                        class="block px-3.5 py-3 text-sm rounded hover:bg-neutral-100"
                    >
                        <span class="block mb-1 font-medium">Blog</span>
                        <span class="block leading-5 opacity-50"
                            >The latest from Presage</span
                        >
                    </a>
                </div>
            </div>
        <div
            x-show="navigationMenu == 'learn-more'"
            class="flex items-stretch justify-center w-full max-w-2xl p-6 gap-x-3"
        >
            <div
                class="flex-shrink-0 w-48 rounded pt-28 pb-7 bg-gradient-to-br from-neutral-800 to-[#00415b]"
            >
                <img
                    src="/assets/Presage_Logo_TXTwhite.svg"
                    style="width: 300px; height: 300px"
                />
                <div class="relative px-7 text-white">
                    <span class="block text-sm opacity-60"
                        >Applications across industries</span
                    >
                </div>
            </div>
            <div class="w-72">
                <a
                    href="/pages/industries/airlines/"
                    @click="navigationMenuClose()"
                    class="block px-3.5 py-3 text-sm rounded hover:bg-neutral-100"
                >
                    <span class="block mb-1 font-medium">Airlines and Aerospace</span>
                    <span class="block font-light leading-5 opacity-50"
                        >Pilot decision-making, GADM&E, flight deck culture, flight path management</span
                    >
                </a>
                <a
                    href="/pages/industries/airtraffic/"
                    @click="navigationMenuClose()"
                    class="block px-3.5 py-3 text-sm rounded hover:bg-neutral-100"
                >
                    <span class="block mb-1 font-medium">Air Traffic Control</span>
                    <span class="block font-light leading-5 opacity-50"
                        >ATS decision-making, organizational safety culture</span
                    >
                </a>
                <a
                    href="/pages/industries/utilities/"
                    @click="navigationMenuClose()"
                    class="block px-3.5 py-3 text-sm rounded hover:bg-neutral-100"
                >
                    <span class="block mb-1 font-medium"
                        >Utilities</span
                    >
                    <span class="block leading-5 opacity-50"
                        >Organizational culture, policy alignment, frontline decision-making</span
                    >
                </a>
                <a
                    href="/pages/industries/health/"
                    @click="navigationMenuClose()"
                    class="block px-3.5 py-3 text-sm rounded hover:bg-neutral-100"
                >
                    <span class="block mb-1 font-medium">Health and Medicine</span>
                    <span class="block leading-5 opacity-50"
                        >Medical professional culture, mental health, and decision-making</span
                    >
                </a>
            </div>
        </div>
    </div>
</nav>
